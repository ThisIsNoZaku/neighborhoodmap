"use strict";function findPlaces(a){return model.displayedLocations(null),$.ajax("yelp",{data:{latitude:40.7128,longitude:-74.0059,category_filter:a}}).done(function(a){model.displayedLocations(a.businesses)})}function displayCategory(a){if(a){model.displayedLocations([]);var b=model.categories()[a];findPlaces(b)}}function selectCategory(a){model.selectedCategory(a)}function selectPoi(a){model.selectedLocation(a),centerMap({lat:a.location.coordinate.latitude,lng:a.location.coordinate.longitude})}function centerMap(a){a&&map.panTo(a)}var map,drawingManager,places,markers=[],model={categories:ko.observable([]),selectedCategory:ko.observable(),displayedLocations:ko.observableArray([]),selectedLocation:ko.observable()};ko.applyBindings(model),model.selectedCategory.subscribe(displayCategory),model.selectedCategory.subscribe(console.log),model.displayedLocations.subscribe(function(a){$.each(markers,function(a,b){b.setMap(null)}),model.selectedLocation(null)},null,"beforeChange"),model.displayedLocations.subscribe(function(a){markers=[],$.each(a,function(a,b){var c=new google.maps.Marker({position:{lat:b.location.coordinate.latitude,lng:b.location.coordinate.longitude},draggable:!1,map:map});markers.push(c),function(){c.addListener("click",function(){selectPoi(b)})}()})}),$(document).ready(function(){var a=document.getElementById("map");map=new google.maps.Map(a,{center:{lat:33.4936,lng:-117.1484},zoom:15,clickable:!1,disableDefaultUi:!0,styles:[{featureType:"poi",stylers:[{visibility:"off"}]}],events:{click:function(){}}}),drawingManager=new google.maps.drawing.DrawingManager({drawingMode:null,drawingControl:!1}),drawingManager.setMap(map)}),$.ajax("static/data/categories.json",{}).done(function(a){a=JSON.parse(a),model.categories(a.categories);model.categories();model.selectedCategory("All")}),$(window).resize(function(){if(model.selectedLocation()){var a=model.selectedLocation().location.coordinate;centerMap({lat:a.latitude,lng:a.longitude})}});